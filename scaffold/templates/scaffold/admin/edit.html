{% extends "admin/change_form.html" %}
{% load i18n %}
{% block breadcrumbs %}
<div class="breadcrumbs">
     <a href="{%url admin:index%}">{% trans "Home" %}</a> &rsaquo;
     <a href="{%url sections:node_index%}">{% trans "Sections" %}</a> &rsaquo; 
     Edit {{node.type}} <em>{{node.title}}</em>
</div>
{% endblock %}
{% block content %}
<div id="content-main">
    {{ form.media }}
    <link rel="stylesheet" href="{{MEDIA_URL}}styles/sections-admin.css" type="text/css" media="all">
    {%ifnotequal node.depth 1%}
    <p class=note">You are editing a subsection.</p>
    {%else%}
    <p class=note">You are editing a section.</p>
    {%endifnotequal%}
    <form enctype="multipart/form-data" action="{%url sections:edit node_id=node.pk%}" method="POST">
    <table>
    {{ form.as_table }}
    <tr><td colspan="2"><h3>Section Library Sources:</h3></td></tr>
    {{source_inline_form.as_table}}
    </table>
    
    <input type="submit" value="Save" />
    </form>
    <a class="move" href="{%url sections:move node_id=node.pk%}">Move this {%ifnotequal node.depth 1%}subsection{%else%}section{%endifnotequal%} &raquo;</a>
    <h2>Items Belonging to this {{node.type}}</h2>
    <table>
    <thead><tr><th>Title</th><th>Content Type</th></thead>
    <tbody>
    {%for item, app, obj, relationship_type in fk_related_items%}
        <tr>
            <td><a href="{{item.get_absolute_url}}">{{item}}</a></td><td>{{obj}}</td>
        </tr>
    {%empty%}
        <tr><td colspan="2">No objects assigned to the section.</td></tr>
    {%endfor%}
    </tbody>
    </table>
</div>
{%if node.is_root%}
<script type="text/javascript">
$(document).ready(function () {
    // Hide fields which are not required for root nodes.
    var labels = ['id_sub_teaser']
    for (var i = 0; i < labels.length; i++) {
        $("label[for='" + labels[i] + "']").parent().parent().hide();
    }
});
</script>
{%endif%}
{%endblock%}